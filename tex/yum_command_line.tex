%-------------------------------------------------------------------------------
% yum_command_line
%-------------------------------------------------------------------------------
%
% \file        yum_command_line.tex
% \library     Documents
% \author      Chris Ahlstrom
% \date        2015-09-06
% \update      2018-05-26
% \version     $Revision$
% \license     $XPC_GPL_LICENSE$
%
%     Provides the description of the no-gui mode of Yoshimi.
%
%-------------------------------------------------------------------------------

\section{The Yoshimi Command Line Interface}
\label{sec:command_line}

   \index{CLI}
   \index{cmd}
   \index{command line}
   \textsl{Yoshimi} provides a "no GUI" or "command-line" mode of operation
   where many aspects of the application can be controlled via text commands.
   This mode is useful for blind people and for programmers, for example.  To
   access this mode, add the \texttt{-i} or \texttt{--no-gui} command-line
   option when starting \textsl{Yoshimi} on the command-line.  But note that,
   when starting \textsl{Yoshimi} on the command-line, the "command-line" mode
   of operation is available at the same time as the GUI, as well.

   One of the main features of recent \textsl{Yoshimi} releases
   is improved non-GUI accessibility.  In fact,
   \textsl{Yoshimi} can run with neither GUI nor CLI input access. Working
   purely as a hidden MIDI device, a daemon of sorts. To enable a tidy close,
   there is a new short-form NRPN. Just send 68 to both MSB and LSB (CC 99 and
   CC98).

   In a command line environment, almost all the 'running' commands are
   available, but none of the instrument editing ones are... yet!  One can
   decide what MIDI/audio setup is wanted, list and set roots and banks, load
   instruments into any part, change a part's channel, set main volume and key
   shift, and set up vector control.  A number of first-time defaults have been
   changed to make this feature easier.

   When starting from the command line, an argument can be included for a new
   root path to be defined to point to a set of banks fetched from elsewhere.
   This will be given the next free ID. A future upgrade will allow the ID to
   be set to any valid one when it is created, mirroring the GUI behaviour.

   Once running, almost all configuration can be done within the terminal
   window.  There is also extensive control of roots, banks, parts and
   instruments including the ability to list and set all of these.

   Additional controls that are frequently taken for granted in the GUI, but
   otherwise get forgotten, are \textsl{master key shift} and \textsl{master
   volume}.

   The whole of vector control, and much of MIDI-learn, is also exposed to the
   command line.

   The command-line mode provides extensive error checking and feedback.
   Note the change in nomenclature from "Parameters" to "Patch Set", which is
   visible in the main screen, and also reflected in the command line.
   \index{command level}
   The prompt will always show what \textsl{command level}
   one is on, along with relevant information.
   At the CLI prompt, when effects are being managed, the preset number is also
   shown on the prompt so you'll typically see something like:

   \begin{verbatim}
      yoshimi part 2 FX 1 Rever-7 >
   \end{verbatim}

   One will also get a confirmation message, but, for clarity,
   those are not included in the examples below.
   Here is an example session:

   Starting from the \texttt{yoshimi} prompt:

   \begin{verbatim}
      yoshimi> s p 2 pr 107
      yoshimi part 2 >
   \end{verbatim}

   This command \textbf{s}ets \textbf{p}art number 2 to \textbf{pr}ogram
   number 107 from the \textsl{current} instrument bank.
   \textsl{Yoshimi} is now on part 2 as the current part (indicated by the
   prompt), and all subsequent commands will relate to this "level".
   At this level, one can change the current part simply with:

   \begin{verbatim}
      yoshimi part 2 > s 4
      yoshimi part 4 >
   \end{verbatim}

   \textsl{Yoshimi} is now on part number 4. Now set an effect:

   \begin{verbatim}
      yoshimi part 4 > s ef ty re
      yoshimi part 4 FX 1 rever-1 >
   \end{verbatim}

   This command \textbf{s}ets the part's \textbf{ef}fect 1 (implicit) to
   \textbf{ty}pe \textbf{re}verb.

   Note that many settings parameters are optional, and if you omit them,
   either a default or last-used value will be assumed. Also, names are
   truncated to 5 characters so the prompt line doesn't get unmanageably long.

   From here you can set a preset for this effect:

   \begin{verbatim}
      yoshimi part 4 FX 1 rever > s pre 3
   \end{verbatim}

   Since V 1.5.0 the \textbf{pre}sets have been shown in the prompt, and one
   will still get a confirmation message.

   Settings that follow in a direct command "path" through several levels
   can be made all at once, and one will be left at the appropriate level.
   Thus, summarizing some of the above commands:

   \begin{verbatim}
      s p 4 ef 2 ty re
      yoshimi part 4 FX 2 rever >
   \end{verbatim}

   One cannot combine \texttt{type} and \texttt{preset} as they
   are both at the same level.  To go back one level, use the
   ".." command (reminiscent of the \texttt{cd ..} operation in an OS command
   shell):

   \begin{verbatim}
      yoshimi part 4 FX 2 rever > ..
      yoshimi part 4 >
   \end{verbatim}

   To go back to the top command level, use the "/" command:

   \begin{verbatim}
      yoshimi part 4 > /
      yoshimi >
   \end{verbatim}

   These two special level-movement commands can also be put on the front of
   any other command.  Starting where we were before:

   \begin{verbatim}
      yoshimi part 4 FX 2 rever > .. s vol 70
      yoshimi part 4 >
   \end{verbatim}

   Part 4 volume is now at 70, and \textsl{Yoshimi} is once again at the
   "part level", not the "part FX level".  Also note that the space after
   the ".." is optional.

   The help menus and lists are also partially context sensitive. This
   feature should help avoid clutter and confusion.

   As well as an immediate history, \textsl{Yoshimi} maintains a single command
   history file for all instances of \textsl{Yoshimi} that records any
   non-duplicated loads or save.  Thus, provided one makes a normal
   command-line exit, the last commands will be available on the next run of
   \textsl{Yoshimi}.
   The command-line now has formal methods of opening, selecting and closing
   additional instances.

   When loading external files from the command line, there is an alternative
   to entering the full name if \textsl{Yoshimi} has already seen this file and
   it is in the history list. In this situation you enter '@' followed by the
   list number.

   \begin{verbatim}
      yoshimi> l h v
       
      Recent Vectors:
      1  /home/will/another.xvy
      2  /home/will/Subtle.xvy
      3  /home/will/excellent.xvy
      4  /home/will/yoshimi-code/examples/CoolSound.xvy

      yoshimi> lo ve @4
      Main Vector Loaded /home/will/yoshimi-code/examples/CoolSound.xvy to chan 1
   \end{verbatim}

   The loading of externally-saved instruments is also done, by default,
   relative to one's \textsl{Yoshimi} home directory.  However, saving an
   external instrument from the command-line still requires a full pathname.

   \index{cmd!at-sign}
   The 'recent history' lists can now load MIDI-learned files, patchsets, or
   vector files numerically from the associated list instead of having to type
   the names out.  This uses the '@' (list number) operator.

   Originally this section described the currently implemented commands,
   but as the command set is very much a moving target, it is simpler to just
   ask one to run \textsl{Yoshimi} and type the "?" command.

   Commands with "*" in the description need the setup to be saved,
   and \textsl{Yoshimi} restarted to be activated. 

   Note that \textsl{Yoshimi}'s command-line can also load and save states,
   patchsets, and scales, and can list recent histories.
   Vector load and save is also supported from the command-line.
   That's a complete vector set, with all mappings, instruments, etc.
   One can independently decide which
   channel to load and save from, so that one
   can actually build up a vector set in
   (say) channel 3, then later decide to use it in channel 7.
   It has the extension \texttt{.xvy}, standing for "Xml/Vector/Yoshimi".
   It will eventually be integrated with the saved states.

   Another small detail is that all of the minimum command-line
   abbreviations are now \textbf{C}apitalised in the help list.     

   More features will be added, and the organisation of them may be changed
   slightly.  If any configuration settings are changed, either at the
   command-line or in the graphical user-interface, one will be given a warning
   when exiting, with the option to continue running so one can save the
   changes.

\subsection{Command Level}
\label{subsec:command_line_command_level}

   \index {cli!command level}
   A command level
   \index {cli!context level}
   (also known as a "context level")
   is simply a position in the hierarchy of commands that cover
   some aspect of \textsl{Yoshimi} functionality.

   The levels that currently exist are:

   \begin{itemize}
      \item \textbf{Top Level}
      \item \textbf{System Effects}
      \item \textbf{Insertion Effects}
      \item \textbf{Part}
      \item \textbf{Part Effects}
      \item \textbf{Scales (microtonal)}
      \item \textbf{Vector}
   \end{itemize}

Ones that we're pretty sure will be added are:

   \begin{itemize}
      \item \textbf{Controllers}
      \item \textbf{Addsynth}
      \item \textbf{Addsynth Voice}
      \item \textbf{Subsynth}
      \item \textbf{Padsynth Harmonics}
      \item \textbf{Padsynth Envelopes}
   \end{itemize}

   Any level that has a direct numerical content will be changeable simply with
   "set (n)" once you are at that level.  The level will, of course, be
   indicated by the text in the \textsl{Yoshimi} prompt.

   For example, one can have 1 to 16 vector channels, so from the
   \textsl{Top} level, the following command
   will return the default  (1 or the last-used number):

   \begin{verbatim}
      set vector
      s ve
   \end{verbatim}

   Given this level (the \textsl{Vector} level), the following commands...

   \begin{verbatim}
      set 5 
      s 5
   \end{verbatim}

   ...will then switch to vector channel 5.
   However, at the start, one could have gone straight there with:

   \begin{verbatim}
      set vector 5
      s ve 5
   \end{verbatim}

   A more detailed discussion of command-line vector control is presented in
   \sectionref{subsection:vector_command_line}.

\subsection{Command Tables}
\label{subsec:command_line_command_table}

   When running from the command line, these commands
%  (see \tableref{table:yoshimi_text_commands_part_1}
%  and \tableref{table:yoshimi_text_commands_part_2})
   can be entered after the 'up and running' message.
   The commands are \textsl{not} case-sensitive.
   The commands can be abbreviated to the first three letters of each command,
   or, in some cases, just one letter.
   The commands that are available depend on the current "context" of the
   command line.
   There are a group of commands that are always available. These are

   \begin{itemize}
      \item \texttt{\textbf{?}} or \texttt{\textbf{help}}
      \item \texttt{\textbf{L}ist}
      \item \texttt{\textbf{RES}et}
      \item \texttt{\textbf{EX}it}
   \end{itemize}

   Apart from these basic commands, the command line works on a system of
   context levels, and normally only the commands relevant to that "level"
   will be available.

   This whole section needs a rewrite unfortunately, as it has changed
   dramatically. The good news is that the new format has the seal of approval
   from blind users, and so is very unlikely to change. However, new list and
   context levels will be added once Will starts implementing the part engine
   controls in a near-future version.

   We will describe the new command lists here. These lists are all relative to
   a particular context, and are what one will get if one simply enters
   \textbf{?} while at that level.
   However the command lists can all be called \textsl{specifically} from any
   level. From any higher level, \textbf{? ?} will show the top level one.

%  ------------------------------------------------------------------------
%     START OF REPLACEMENT SECTION
%  ------------------------------------------------------------------------

\subsubsection{Top Commands}
\label{subsec:command_line_top_command_list}

   These commands are part of the Top context/command level.
   First, one gets the default options, always available.
   Then there are several options that have ellipsis (...);
   these are the context submenus.
   After that come all the actual top level controls; there are still a lot!

   \begin{verbatim}
      yoshimi> ?
   \end{verbatim}

   First, note that there are a number of commands common to all command levels.
   We describe them only here.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Common Commands}
      \label{table:yoshimi_text_common_commands}
      \begin{tabular}{l l}

\texttt{?,  Help} &
   Show commands.  Also note specialized versions such as \textbf{? list}. \\
\texttt{STop} &
   All sound off.  Stop!  Panic! \\
\texttt{RESet} &
   Return to start-up conditions (if answering 'y' to the prompt). \\
\texttt{EXit} &
   Tidy up and close Yoshimi (if 'y' to the prompt). \\
\texttt{..} &
   Step back one command level. \\
\texttt{/} &
   Step up to top command level. \\

   The \textbf{RESet} command will ask for confirmation, and, if allowed, will
   reset \textsl{Yoshimi} to startup conditions.  However, note that this will
   \textsl{not} clear any MIDI-learned lines.
   The \textbf{EXit} command will ask for confirmation, and, if allowed, will
   perform a clean exit.

      \end{tabular}
   \end{table}

   \begin{table}[H]
      \centering
      \caption{Yoshimi Top-Level Commands}
      \label{table:yoshimi_text_toplevel_commands}
      \begin{tabular}{l l}

\texttt{Part [n1] ...} &
   Start part operations.  See below. \\
\texttt{VEctor [n1] ...} &
   Start vector operations. \\
\texttt{SCale ...} &
   Scale (microtonal) operations. \\
\texttt{LIst ...} &
   Show various available parameters. \\
\texttt{LOad ...} &
   Load various files. \\
\texttt{SAve ...} &
   Save various files. \\
\texttt{COnfig ...} &
   Engage configuration settings. \\
\texttt{ADD} &
   Add paths and files. \\
\texttt{ADD Root [s]} &
   Add a root path [s] to the root list. \\
\texttt{ADD Bank [s]} &
   Add a bank [s] to the current root. \\
\texttt{REMove} &
   Remove paths, files, and entries. \\
\texttt{REMove Root [n]} &
   De-list root path ID [n]. \\
\texttt{REMove Bank [n]} &
   Delete bank ID [n] (and all its contents) from the current root. \\
\texttt{REMove MLearn [s] [n]} &
   Delete MIDI learned values: 'ALL' removes whole list, or select line [n]. \\
\texttt{Set / Read} &
   Set or read all main parameters. See below for context levels. \\
\texttt{Set/read Root [n]} &
   Read the current root path or set it to ID [n]. \\
\texttt{Set/read Bank [n]} &
   Read the current bank or set the current bank to ID [n]. \\
\texttt{Set/read MLearn [n] [s]} &
   MIDI learned line number [n] control.  See below. \\
\texttt{SYStem effects [n]} &
   System effects for editing. \\
\texttt{SYStem effects SEnd [n2] [n3]} &
   Send system effect to effect [n2] at volume [n3]. \\
\texttt{SYStem effects preset [n2]} &
   Set effect preset to number [n2]. \\
\texttt{INSert effects [n1]} &
   Add an nsertion effect [n1] for editing. \\
\texttt{INSert effect SEnd [s]/[n2]} &
   Set effect [s] where [n2] = (Master, Off or part number). \\
\texttt{Insert effect PREset [n2]} &
   Set numbered effect preset to [n2]. \\
\texttt{AVailable [n]} &
   Set the available number of parts, [n] = 16, 32, 64. \\
\texttt{Volume [n]} &
   Set Master volume to [n]. \\
\texttt{SHift [n]} &
   Master key shift in semitones [n] (0 no shift). \\
\texttt{DEtune [n]} &
   Set the master fine detune to [n] to match other sound sources. \\
\texttt{SOlo [n]} &
   Set the channel 'solo' switcher t [n]
   (0 = off, 1 = row, 2 = col, 3 = loop) \\
\texttt{SCC [n]} &
   Set incoming 'solo' channel number to [n]. \\
\texttt{TIMes [s]} &
   Time display on instrument load message (ENable / other). \\
\texttt{'...'} &
   Help sub-menu. \\

      \end{tabular}
   \end{table}

\paragraph{SOlo}
\label{paragraph:command_line_solo}

   The \textbf{SOlo [s] [n]} and \textbf{CC [n]}
   commands enable and set \textsl{Yoshimi}'s 'Solo' feature,
   whereby one can silently switch MIDI input to different parts.
   The [n] parameter can be 0 = off, 1 = row, 2 = col, and 3 = loop).
   'Row' and 'Loop' mode use the first 16 parts, while
   'Column' mode can use all possibly 64 parts.

   This setting has to be decided before setting 'CC', which then determines
   which channel to listen to for performing the actual switch.

   See \sectionref{subsec:mixer_panel_window}; it goes into more details about
   this setting, at a user-interface level.

\paragraph{Set / Read Context Levels}
\label{paragraph:command_line_context_levels}

   The Set / Read commands set or read all main parameters.  There are a few
   commands that set the context or command level, where additional commands
   peculiar to the "context" are provided.  Here are the command/context levels
   (also see \sectionref{subsec:command_line_command_level}.)
   Note that we also list commands for the effects levels.

   \begin{itemize}
      \item \texttt{Part}. Enter context level for part operations.
      \item \texttt{VEctor}. Enter context level for vector operations.
      \item \texttt{SCale}. Enter context level for scale (microtonal) operations.
      \item \texttt{MLearn}. Enter context level for MIDI Learn operations.
      \item \texttt{COnfig}. Enter context level for configuration settings.
      \item \texttt{SYStem effects [n]}. Enter effects context level.
      \begin{itemize}
         \item \texttt{Type [s]}.  Set the effect type.
         \item \texttt{PREset [n2]}. Set the numbered effect preset to n2.
         \item \texttt{SEnd [n2] [n3]}. Send a system effect to effect n2
            at volume n3.
      \end{itemize}
      \begin{itemize}
   \item \texttt{INSert effects [n1]}. Enter effects context level.
         \item \texttt{Type [s]}. Set the effect type.
         \item \texttt{PREset [n2]}. Set numbered effect preset to n2.
         \item \texttt{SEnd [s]/[n2]}. Set where to send the effect
            ('Master', 'Off', or a part number).
      \end{itemize}
   \end{itemize}

\paragraph{Part Command Level}
\label{paragraph:command_line_context_level_part}

   This command switches to the part context level and makes all its commands
   accessible.  If no number '[n]' is entered it will be on the default part
   (1) or whatever was the previous part in use.
   See \sectionref{subsec:command_line_part_command_list}, which goes into
   details.

\paragraph{MLearn}
\label{paragraph:command_line_mlearn}

   The commands for MLearn are the following values for the [s] parameter:

   \begin{itemize}
      \item \texttt{MUte}, which Enables or, for any other provide token
         disables this line.
      \item \texttt{7Bit} will Enable incoming (learned) NRPNs as a 7-bit value.
      \item \texttt{CC [n2]} will set the incoming controller value that will
         be recognized.  This command can re-order the list.
      \item \texttt{CHan [n2]} will set the incoming channel number that will
         be recognized.  This command can re-order the list.
      \item \texttt{MIn [n2]} will set the conversion for the incoming
         value to a minimum percentage.
      \item \texttt{MAx [n2]} will set the conversion for the incoming
         value to a maximum percentage.
      \item \texttt{LImit [s]} set to Enable will use limiting instead of
         compression.  The conversion uses the minimum and maximum limits.
      \item \texttt{BLock [s]} set to Enable inhibits other lines on this
         CC/channel pair.  It prevents this CC/channel pair from being passed
         on to any other lines or system controls.  It has not effect if the
         line has been disabled.
   \end{itemize}

\subsubsection{Part Commands}
\label{subsec:command_line_part_command_list}

   Next we have the part list. It's now much clearer than it was! Notice it was
   called from the top level with '? part':

   \begin{verbatim}
      yoshimi> ? part
   \end{verbatim}

   In the table that follow, we leave off the following commands, already noted
   above in the first table
   (see \sectionref{subsec:command_line_top_command_list}):
   \textbf{?}, \textbf{Help}, \textbf{STop}, \textbf{RESet},
   \textbf{EXit}, \textbf{..}, and \textbf{/}.

   Note that, for a part, [n1] is the part number.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Part Commands}
      \label{table:yoshimi_text_part_commands}
      \begin{tabular}{l l}

\texttt{ENable} &
   Enables the part and MIDI and virtual keyboard access. \\
\texttt{DIsable} &
   Disables the part. \\
\texttt{Volume [n2]} &
   Set the part's volume to [n2]. \\
\texttt{Pan [n2]} &
   Set part's L/R panning to [n2]. 64 = center. \\
\texttt{VElocity [n2]} &
   Set part velocity sensing sensitivity to [n2]. \\
\texttt{OFfset [n2]} &
   Set velocity sense offset (start point) to [n2]. \\
\texttt{POrtamento [s]} &
   Set portamento. ([s] = Enable, other values disable it). \\
\texttt{Mode [s]} &
   Set keying mode ([s] = Poly, Mono, Legato). \\
\texttt{Note [n2]} &
   Set maximum note polyphony value to [n2]. \\
\texttt{SHift [n2]} &
   Set key shift semitones to [n2] (0 = no shift). \\
\texttt{MIn [n2]} &
   Set the minimum MIDI note value accepted to [n2]. \\
\texttt{MAx [n2]} &
   Set the maximum MIDI note value accepted to [n2]. \\
\texttt{EFfects [n2]} &
   Enter Effects command level, and set effects number to [n2], if given. \\
\texttt{Effects Type [s]} &
   Set the effect type to [s]. \\
\texttt{Effects PREset [n3]} &
   Set the numbered effect preset to [n3]. \\
\texttt{Effects Send [n3] [n4]} &
   Send part to system effect [n3] at volume [n4]. \\
\texttt{PRogram [n2]} &
   Loads instrument ID [n2] in the current bank. \\
\texttt{NAme [s]} &
   Sets the display name the part can be saved with to [s]. \\
\texttt{Channel [n2]} &
   Set part's MIDI channel ([n2] > 32 disables, [n2] > 16 note-off only). \\
\texttt{Destination [s2]>} &
   JACK audio destination ([s2] = Main, Part, Both) \\

      \end{tabular}
   \end{table}

   For the \textbf{Part Name} command, this sets the display name the part can
   be saved with, either in a bank or externally.
   For the \textbf{Part Channel} command, this sets the incoming MIDI channel
   the part recognises. If it is set greater than 32, then all messages will be
   ignored.  If it is set greater than 16, then only Note-Off messages will be
   recognised.
   For the \textbf{Part Destination} command, for JACK audio only,
   this sets where this part's audio will be sent. It can be the main output
   pair, the part's output pair or both.

\subsubsection{Vector Commands}
\label{subsec:command_line_vector_command_list}

   The vector list is called from the part level with '? ve'.

   \begin{verbatim}
      yoshimi part 1 on> ? ve
   \end{verbatim}

   The commands at this level deal with control of an X axis and a Y axis.
   The CC for the X axis must be set before everything else.  Then the CC for
   the Y axis must be set.  Finally, the other Y controls can be set.

   In the table that follows, we leave off the commands already noted
   above in the first table
   (see \sectionref{subsec:command_line_top_command_list}).

   Note that for vector, [n1] = base channel.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Vector Commands}
      \label{table:yoshimi_text_vector_commands}
      \begin{tabular}{l l}

\texttt{VEctor [n1]} &
   Vector channel operations. \\
\texttt{[X/Y] CC [n2]} &
   CC [n2] is used for theX or Y axis sweep. \\
\texttt{[X/Y] Features [n] [s]} &
   Sets X or Y features [n] = 1 to 4 ([s] = Enable, Reverse, other = off).  \\
\texttt{[X] PRogram [l/r] [n2]} &
   Sets X program change ID [n2] for left or right part. \\
\texttt{[Y] PRogram [d/u] [n2]} &
   Sets Y program change ID [n2] forL DOWN or UP part. \\
\texttt{[X/Y] Control [n2] [n3]} &
   Sets [n3] CC to use for X or Y feature [n2] = 2 to 4. \\
\texttt{Off} &
   Disables vector control for this channel.  Parts are unchanged. \\
\texttt{Name [s]} &
   Sets the internal name for this complete vector.  \\

      \end{tabular}
   \end{table}

   The \textbf{X/Y Features [n2]} command sets the features for the
   selected axis, and also if they are to be off or reversed.
   See the \textbf{Features} section,
   \sectionref{subsec:command_line_command_descriptions}, for more information.
   It seems to indicate a feature range of 1 to 4, not 2 to 4.

   The \textbf{X/Y Control [n2] [n3]} command
   sets the [n3] CC to use for the X or Y feature [n2] = 2 to 4. 
   This allows a change of the actual CC associated with features 2 through 4.
   They can be any CC that \textsl{Yoshimi} recognises.

\subsubsection{Scales Commands}
\label{subsec:command_line_scales_command_list}

   A completely new one is the scales list:

   \begin{verbatim}
      yoshimi> ? sc
   \end{verbatim}

   In the table that follow, we leave off the following commands, already noted
   above in the first table
   (see \sectionref{subsec:command_line_top_command_list}):
   \textbf{?}, \textbf{Help}, \textbf{STop}, \textbf{RESet},
   \textbf{EXit}, \textbf{..}, and \textbf{/}.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Scales Commands}
      \label{table:yoshimi_text_scales_commands}
      \begin{tabular}{l l}

\texttt{FRequency [n]} &
   Set the 'A' note's actual frequency to [n], usually 440 Hz. \\
\texttt{NOte [n]} &
   Set the 'A' note's number to [n]. \\
\texttt{Invert [s]} &
   Invert the entire scale ([s] = enable, other values = off) \\
\texttt{CEnter [n]} &
   Set the note number of the key's center to [n]. \\
\texttt{SHift [n]} &
   Shift the entire scale up or down by [n]. \\
\texttt{SCale [s]} &
   Activate microtonal scale ([s] = enable, other values = off). \\
\texttt{MApping [s]} &
   Activate keyboard mapping ([s] = enable, other values = off). \\
\texttt{FIrst [n]} &
   Set the first note number to be mapped to [n]. \\
\texttt{MIddle [n]} &
   Set the middle note number to be mapped to [n]. \\
\texttt{Last [n]} &
   Set the last note number to be mapped to [n]. \\
\texttt{Tuning [s] [s2]} &
   Set the CSV tuning values (see below). \\
\texttt{Keymap [s] [s2]} &
   Set the CSV keymap (n1, n2, n3, etc.); s2 = 'IMPort' from named file. \\
\texttt{NAme [s]} &
   Set the internal name for this scale. \\
\texttt{DEscription [s]} &
   Sets the description of this scale. \\
\texttt{CLEar} &
   Clear all settings and revert to the standard scale. \\

      \end{tabular}
   \end{table}

\paragraph{Scales / Tuning [s] [s2]}
\label{paragraph:command_line_tuning}

   Tuning sets the CSV tuning values, which are decimal numbers or ratios
   (n1.n1 or n1/n1, n2.n2 or n2/n2, etc.).
   The [s2] parameter requests an 'IMPort' from a named file, which is
   \index{.scl}
   \index{config!.scl}
   a \texttt{.scl} file.

\paragraph{Scales / Keymap [s] [s2]}
\label{paragraph:command_line_keymap}

   Keymap either sets the keyboard mapping values as a comma separated list, or
   imports a
   \index{.kbm}
   \index{config!.kbm}
   \texttt{.kbm} file from a named file [s2].

\subsubsection{Help List}
\label{subsec:command_line_help_list}

   You can now clearly see which items can be listed with:

   \begin{verbatim}
      yoshimi> ? li
      yoshimi> ? list
      yoshimi> help
   \end{verbatim}

   In the table that follow, we leave off commands noted above
   (see \sectionref{subsec:command_line_top_command_list}).

   \begin{table}[H]
      \centering
      \caption{Yoshimi Help Commands}
      \label{table:yoshimi_text_help_commands}
      \begin{tabular}{l l}

\texttt{Roots} &
   List all available root paths. \\
\texttt{Banks [n]} &
   List the banks in root ID [n] or the current root.  See below. \\
\texttt{Instruments [n]} &
   List instruments in bank ID [n] or current bank. See below.  \\
\texttt{Parts} &
   List parts with instruments installed. \\
\texttt{Vectors} &
   List settings for all enabled vectors. \\
\texttt{Settings} &
   List dynamic settings. \\
\texttt{Tuning} &
   Microtonal scale tunings. See the Scales section. \\
\texttt{Keymap} &
   Microtonal scale keyboard map.  See the Scales section. \\
\texttt{Config} &
   Show the current configuration. See the Config section. \\
\texttt{MLearn [s[n]]} &
   MIDI learned controls ('@n' for full details on one line). \\
\texttt{History [s]} &
   Show recent files. See below. \\
\texttt{Effects [s]} &
   Show effect types ([s] = 'all' includes preset numbers and names). \\
\texttt{PREsets} &
   Show all the presets for the currently selected effect. \\

      \end{tabular}
   \end{table}

A few more detailed descriptions occur in the following sections.

\paragraph{List / Banks [n]}
\label{paragraph:command_line_list_banks}

   This command shows all of the banks present in either the numbered ([n])
   bank root, or in the current one (if no number is provided).

\paragraph{List / Instruments [n]}
\label{paragraph:command_line_list_instruments}

   This command shows all of the instruments present in either the numbered
   ([n]) bank root, or in the current one (if no number is provided).

\paragraph{List / History [s]}
\label{paragraph:command_line_list_history}

   Show the recent history of the following items [s]:
   Instruments, Patchsets, SCales, STates, Vectors, and MLearn).
   If no parameter is provided, show them all.

   The last-used file in any section is now always at the top of its history list,
   so it's easier to pick up where one left off.
   Instruments, patch sets, vectors, scales, MIDI-learn and state all offer the
   most recent entry whenever one wants to load or save.  On first-time use (when
   there is no history) the home directory will be offered as a location,
   regardless of where \textsl{Yoshimi} was called from.

   In the specific case of instruments, when \textsl{saving},
   one is offered the instrument in the currently-selected part to the home
   directory, otherwise, when saving these 'managed' files,
   one won't be offered the previous last-used entry unless it was seen on that
   session, either by being loaded, or saved by name. This is to give some
   protection against accidental overwrites.

   For example:
   You have been working on the 'foo' instrument
   for a whole day, saving the whole patch set as you
   go. Then, the following day, you start up \textsl{Yoshimi}
   and immediately have a completely
   new idea 'bar' and start working on it. Without thinking, you save and hit
   Enter. Oops, your just wiped out 'foo'.
   Only now you haven't, because while loading \textsl{Yoshimi}
   would see the older file, so that saving
   will offers your home directory to put a new name in.

\paragraph{List / Effects [s]}
\label{paragraph:command_line_list_effects}

   Show the effect types.
   [s] = 'All' includes preset numbers and names.
   If this command is called from the Effects level, then one see only the name
   of the current effect and the number of presets.

\subsubsection{Load/Save List}
\label{subsec:command_line_loadsave_list}

   And the same for load and save:

   \begin{verbatim}
      yoshimi> ? lo
      yoshimi> ? sa
   \end{verbatim}

   In the table that follow, we leave off the commands noted above
   (see \sectionref{subsec:command_line_top_command_list}).

   \begin{table}[H]
      \centering
      \caption{Yoshimi Load Commands}
      \label{table:yoshimi_text_load_commands}
      \begin{tabular}{l l}

\texttt{Instrument [s]} &
   Load instrument to current part from a named file [s]. \\
\texttt{SCale [s]} &
   Load and activate scale settings from named file [s]. \\
\texttt{VEctor [n] [s]} &
   Load and activate vector to channel n (or saved) from named file [s]. \\
\texttt{Patchset [s]} &
   Load and activate a complete patch set from named file [s]. \\
\texttt{MLearn [s]} &
   Load the full MIDI learned list from named file [s]. \\
\texttt{STate [s]} &
   Load all system settings and patch sets from named file [s]. \\

      \end{tabular}
   \end{table}

   For the \textbf{Load Instrument} command, the instrument is enabled if it is
   configured to be enabled.  For the \textbf{Load Vector} command, if there is
   no number parameter, the vector is loaded to the channel it was originally
   saved from.
   For the \textbf{Load Patchset} command, all instruments, scales, and vectors
   are loaded from the named file.
   For the \textbf{Load STate} command, all configuration, system settings,
   patch sets, and MIDI-learned lines are loaded from the named file.
   These notes also apply to the \textbf{Save} version of these commands.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Save Commands}
      \label{table:yoshimi_text_loadsave_commands}
      \begin{tabular}{l l}

\texttt{Instrument [s]} &
   Save current part to named file [s]. \\
\texttt{SCale [s]} &
   Save current scale settings to named file [s]. \\
\texttt{VEctor [n] [s]} &
   Save vector on channel n to named file [s]. \\
\texttt{Patchset [s]} &
   Save complete set of instruments to named file [s]. \\
\texttt{MLearn [s]} &
   Save midi learned list to named file [s]. \\
\texttt{STate [s]} &
   Save all system settings etc. to named file [s].  See above. \\
\texttt{Config} &
   Save current configuration. \\

      \end{tabular}
   \end{table}

\subsubsection{Config Commands}
\label{subsec:command_line_config_list}

   Finally there is the new and shiny (and quite big) COnfig command level:

   \begin{verbatim}
      yoshimi> ? con
   \end{verbatim}

   In the table that follow, we leave off the commands noted above
   (see \sectionref{subsec:command_line_top_command_list}).  Also
   note that more complete descriptions follow this table.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Config Commands}
      \label{table:yoshimi_text_config_commands}
      \begin{tabular}{l l}

\texttt{Oscillator [n]} &
   * Add/Pad size (power 2 256-16384). \\
\texttt{BUffer [n]} &
   * Internal size (power 2 16-4096). \\
\texttt{PAdsynth [s]} &
   Interpolation type (Linear, other = cubic). \\
\texttt{Virtual [n]} &
   Keyboard layout (0 = QWERTY, 1 = Dvorak, 2 = QWERTZ, 3 = AZERTY). \\
\texttt{Xml [n]} &
   Set the XML compression level to [n] (0-9). \\
\texttt{REports [s]} &
   Destination for reporting (Stdout, other = console). \\
\texttt{STate [s]} &
   * Autoload default at start (Enable; other = disable). \\
\texttt{Hide [s]} &
   Hide non-fatal errors (Enable; other = disable). \\
\texttt{Display [s]} &
   GUI splash screen (Enable; other = disable). \\
\texttt{Time [s]} &
   Add to instrument load message (Enable; other = disable). \\
\texttt{Include [s]} &
   Include XML headers on file load (Enable; other = disable). \\
\texttt{Keep [s]} &
   Include inactive data on all file saves (Enable; other = disable). \\
\texttt{Gui [s]} &
   * Run with GUI (Enable, Disable). \\
\texttt{Cli [s]} &
   * Run with CLI (Enable, Disable). \\
\texttt{MIdi [s]} &
   * Connection type (Jack, Alsa). \\
\texttt{AUdio [s]} &
   * Connection type (Jack, Alsa). \\
\texttt{ALsa Midi [s]} &
   * Name of ALSA MIDI source. \\
\texttt{ALsa Audio [s]} &
   * Name of ALSA audio hardware device. \\
\texttt{ALsa Sample [n]} &
   * ALSA sampling rate (0 = 192000, 1 = 96000, 2 = 48000, 3 = 44100). \\
\texttt{Jack Midi [s]} &
   * Name of JACK MIDI source. \\
\texttt{Jack Server [s]} &
   * Name of JACK server. \\
\texttt{Jack Auto [s]} &
   * Connect JACK on start (Enable; other = disable). \\
\texttt{ROot [n]} &
   Root CC (0 - 119, other disables). \\
\texttt{BAnk [n]} &
   Bank CC (0, 32, other disables). \\
\texttt{PRogram [s]} &
   MIDI program change enabling (0 is disable, other is enable). \\
\texttt{ACtivate [s]} &
   MIDI program change activates part (0 is off, other is on). \\
\texttt{EXtended [s]} &
   Extended program change (0 is off, other is enable). \\
\texttt{Quiet [s]} &
   Ignore 'reset all controllers' (Enable other). \\
\texttt{Log [s]} &
   Log incoming MIDI CCs (Enable other). \\
\texttt{SHow [s]} &
   GUI MIDI learn editor (Enable other). \\

      \end{tabular}
   \end{table}

   '*' marks entries that need to be saved, and \textsl{Yoshimi}
   restarted, to activate them.

\paragraph{Config / Oscillator [n]}
\label{paragraph:command_line_config_oscillator}

   This sets the size of the buffer used for both AddSynth and PadSynth
   oscillators, and is always a power of 2.

\paragraph{Config / BUffer [n]}
\label{paragraph:command_line_config_buffer}

   This is the size of the audio buffer that \textsl{Yoshimi} uses.  For ALSA
   audio, it will always be the same size as ALSA's buffering, but for JACK it
   can be the same, bigger, or smaller. It also is always a power of 2.

\paragraph{Config / PAdsynth [n]}
\label{paragraph:command_line_config_padsynth}

   Sets the quality of the intepolation that PadSynth uses on its wavetables.
   'Linear' is faster, but 'Cubic' is (potentially) very slightly better
   quality.

\paragraph{Config / Virtual [n]}
\label{paragraph:command_line_config_virtual}

   This setting controls the layout of the virtual keyboard, and can match the
   commonest computer keyboards.

\paragraph{Config / Xml [n]}
\label{paragraph:command_line_config_xml}

   Sets the amount of compression used on all
   \textsl{Yoshimi}'s data files. 9 is the most-compressed setting.
   0 is no compression, so that the configuration file
   can be read in an ordinary text editor.

\paragraph{Config / REports [s]}
\label{paragraph:command_line_config_reports}

   Determines where almost all information and error messages will be sent. A
   few will always go to \texttt{stderr} (such as the ones reporting a GUI
   problem).

\paragraph{Config / STate [s]}
\label{paragraph:command_line_config_state}

   Sets whether a pre-saved default state file will be loaded on start-up.

\paragraph{Config / Hide [n]}
\label{paragraph:command_line_config_hide}

   Sets to ignore non-fatal system errors, or verbose messages.

\paragraph{Config / Display [s]}
\label{paragraph:command_line_config_display}

   Enables \textsl{Yoshimi}'s start-up splash screen (which is
   enabled at first time start).

\paragraph{Config / Time [s]}
\label{paragraph:command_line_config_time}

   Attaches the time an instrument took to load and initialize to the loading
   message.

\paragraph{Config / Include [s]}
\label{paragraph:command_line_config_include}

   Reports version information on all data failures.

\paragraph{Config / Keep [s]}
\label{paragraph:command_line_config_keep}

   Sets up to innclude all data on file saves, including data for
   inactive and random elements.

\paragraph{Config / Gui [s]}
\label{paragraph:command_line_config_gui}

   Run with the graphic user interface enabled.

\paragraph{Config / Cli [s]}
\label{paragraph:command_line_config_cli}

   Run with the command-line interface enabled.

\paragraph{Config / MIdi [s]}
\label{paragraph:command_line_config_midi}

   Sets whether MIDI input comes from JACK or from ALSA.

\paragraph{Config / AUdio [s]}
\label{paragraph:command_line_config_audio}

   Sets whether audio is passed out to JACK or ALSA.

\paragraph{Config / ALsa Midi [s]}
\label{paragraph:command_line_config_alsa_midi}

   Sets the name of an ALSA MIDI source to which
   \textsl{Yoshim}i will try to connect.

\paragraph{Config / ALsa Audio [s]}
\label{paragraph:command_line_config_alsa_audio}

   Sets the name of a hardware audio device to which ALSA will try to connect.

\paragraph{Config / ALsa Sample [n]}
\label{paragraph:command_line_config_alsa_sample}

   Sets the sampling rate when using ALSA audio.

\paragraph{Config / Jack Midi [s]}
\label{paragraph:command_line_config_jack_midi}

   Sets the name of a JACK MIDI source to which
   \textsl{Yoshimi} will try to connect.

\paragraph{Config / Jack Server [s]}
\label{paragraph:command_line_config_jack_server}

   Sets the name of an audio server to which JACK will try to connect.

\paragraph{Config / Jack Auto [s]}
\label{paragraph:command_line_config_jack_auto}

   Determines whether JACK will try to connect the main L=R audio outputs at
   start-up time.

\paragraph{Config / ROot [n]}
\label{paragraph:command_line_config_root}

   Provides the MIDI CC that \textsl{Yoshimi} expects bank root changes to come
   from.

\paragraph{Config / BAnk [n]}
\label{paragraph:command_line_config_bank}

   Provides the MIDI CC that \textsl{Yoshimi} expects bank changes to come from.

\paragraph{Config / PRogram [s]}
\label{paragraph:command_line_config_program}

   Determines whether MIDI program changes are honored or ignored.

\paragraph{Config / ACtivate [s]}
\label{paragraph:command_line_config_activate}

   Enables a part when it gets a MIDI program change message,
   if it was disabled.

\paragraph{Config / Extended [s]}
\label{paragraph:command_line_config_extended}

   Sets a MIDI CC for receiving program changes for the top (extra)
   32 instruments in a bank.

\paragraph{Config / Quiet [s]}
\label{paragraph:command_line_config_quiet}

   Sets up to ignore a MIDI 'reset all controllers' message.

\paragraph{Config / Log [s]}
\label{paragraph:command_line_config_log}

   Displays the value of received MIDI CCs.

\paragraph{Config / SHow [s]}
\label{paragraph:command_line_config_show}

   A setting for the GUI MIDI learn editor, where [s] is 'Enable', or some
   other token to disable the feature.
   This setting indicates to automatically open the MIDI-learn editor window
   when a sucessful 'learn' has been made.

%  ------------------------------------------------------------------------
%     END OF REPLACEMENT SECTION
%  ------------------------------------------------------------------------

%  ------------------------------------------------------------------------
%     START OF OBSOLETE SECTION
%  ------------------------------------------------------------------------

\iffalse
   The brief descriptions in the following table can be obtained using the
   "help" command in the \textsl{Yoshimi} command-line mode.  More detailed
   descriptions are given in the section following the table.

   The \texttt{paths} command no longer exists. Instead we have \texttt{add}
   and \texttt{remove}, so instead of \texttt{path add} it's \texttt{add root}.
   Also, one can now add and remove banks using the same structure.
   \texttt{paths show} has now been moved into lists as \texttt{list roots}.
   These changes make roots/banks/instruments more consistent.

   \begin{table}[H]
      \centering
      \caption{Yoshimi Text Commands, Part 1}
      \label{table:yoshimi_text_commands_part_1}
      \begin{tabular}{l l}

         \texttt{..} &
            Step back up one command level. \\

         \texttt{/} &
            Step back up to the top command level. \\

         \texttt{add bank [s]} &
            Add a new bank to the current root. \\

         \texttt{add root [s]} &
            Define a new root path and add it to the list. \\

         \texttt{remove bank [s]} &
            Delete the bank from the current root. \\

         \texttt{remove root [s]} &
            De-list the given root path. \\

         \texttt{list banks [n]} &
            List instruments in bank \textsl{n} or the current bank. \\

         \texttt{list effects [n]} &
            List effect types for \textsl[n] or for 'all'.  \\

         \texttt{list instruments [n]} &
            List all instruments in bank \textsl{n} or current bank. \\

         \texttt{list parts} &
            List number of parts available, and more. \\

         \texttt{list roots} &
            List all available root paths. \\

         \texttt{list setup} &
            Displays the dynamic system settings. \\

         \texttt{list history [s]} &
            Lists recent files (patchsets, scales, and states).
            If no parameter is given, it lists all three in sequence. \\

         \texttt{list vectors [n]} &
            Lists the settings for enabled vectors, channel \textsl{n}. \\

         \texttt{load instrument s} &
            Loads an instrument to the current part from a named file.
            The parameter \textsl{s} is compulsory. \\

         \texttt{load patchset [s]} &
            Load a complete patch set from the file. \\

         \texttt{load vector [s]} &
            Loads a vector setup from a file. \\

         \texttt{save patchset [s]} &
            Save the patch set to a named file. \\

         \texttt{save instrument s} &
            Saves the current part to a named instrument file.
            The parameter \textsl{s} is compulsory. \\

         \texttt{save setup} &
            Save the current dynamic system settings. \\

         \texttt{save vector [s]} &
            Saves the current vector setup to a named vector file. \\

         \texttt{set activate [n]} &
            Set part-activate on MIDI program change (0 on, 1 off). \\

         \texttt{set alsa audio [s]} * &
            Sets the name of the audio device to look for. \\

         \texttt{set alsa midi [s]} * &
            Sets the name of the MIDI source to look for. \\

         \texttt{set available [n]} &
            Set the number of available parts (16, 32, 64). \\

         \texttt{set bank [n]} &
            Set current bank to ID \textsl{n}. \\

         \texttt{set ccbank [n]} &
            Set MIDI CC for bank changes (non-0 or -32 disables). \\

         \texttt{set ccroot [n]} &
            Set MIDI CC for root path changes (above 119 disables). \\

         \texttt{set extend [n]} &
            Set MIDI CC for extended program change (above 119 disables). \\

         \texttt{set insert effects [n]} &
            Set insertion effects for editing. \\

         \texttt{set jack midi [s]} * &
            Sets the name of the JACK MIDI source for Yoshimi. \\

         \texttt{set jack server [s]} * &
            Sets the name of the JACK server for Yoshimi. \\

         \texttt{set part [n1] program [n2]} &
            Load instrument \textsl{n2} into part \textsl{n1}. \\

         \texttt{set part [n1] channel [n2]} &
            Set the MIDI channel \textsl{n2} for part \textsl{n1}. \\

         \texttt{set part [n1] destination [n2]} &
            Set audio destination of part \textsl{n1}
            to main, part, or both. \\

         \texttt{set preferred audio [s]} * &
            Set audio connection type (jack/alsa). \\

         \texttt{set preferred midi [s]} * &
            Set MIDI connection type (jack/alsa). \\

      \end{tabular}
   \end{table}

   \begin{table}[H]
      \centering
      \caption{Yoshimi Text Commands, Part 2}
      \label{table:yoshimi_text_commands_part_2}
      \begin{tabular}{l l}

         \texttt{set - preset [n]} &
            Set effect preset. \\

         \texttt{set - preset [n]} &
            Set numbered effect preset. \\

         \texttt{set program [n]} &
            Set MIDI program change (0 disables, otherwise enables). \\

         \texttt{set reports [n]} &
            Set report destination (gui, stderr, show, and hide). \\

         \texttt{set root [n]} &
            Set current root path to ID \textsl{n}. \\

         \texttt{set shift [n]} &
            Set master key shift for notes, semitones. \\

         \texttt{set system effects [n]} &
            Set System Effects for editing. \\

         \texttt{set vector [n1] x/y cc [n2]} &
            Sets and enables vector CC.  See section below. \\

         \texttt{set vector [n1] x/y features [n2]} &
            Sets channel \textsl{n1} X or Y features to \textsl{n2}. \\

         \texttt{set vector [n1] x/y program [l/r] [n2]} &
            Loads program \textsl{n2} to ch. \textsl{n1} X or Y
            \textsl{left} or \textsl{right} part. \\

         \texttt{set vector [n1] x/y control [n2] [n3]} &
            Sets \texttt{n3} CC to use for X or Y feature \texttt{n2}
            (2, 4, 8). \\

         \texttt{set vector [n] [off]} &
            Disables vector control for channel \textsl{n}. \\

         \texttt{set volume [n]} &
            Set the master volume. \\

         \texttt{reset} &
            Return to the start-up conditions, if 'y' selected. \\

         \texttt{stop} &
            Cease all sound immediately! \\

         \texttt{?} or \texttt{help} &
            List all commands. \\

         \texttt{exit} &
            Tidy up and close Yoshimi down, if 'y' selected. \\

      \end{tabular}
   \end{table}

   Entries marked with an asterisk need to be saved, and \textsl{Yoshimi}
   restarted, to activatate.

   Commands are not case sensitive, and an invalid one will print a reminder.
   Often one needs only the first letter of a command, as long as it is
   unambiguous. The examples above show their minimum abbreviations in capitals.
   However, Yoshimi is quite pedantic, and if you type the command in full it
   must be exactly correct!

   Since V 1.5.1 all number ranges start from one. This is for compatibility
   with the GUI.

   More commands will be added, and the organisation of the commands
   may change slightly.

\fi

%  ------------------------------------------------------------------------
%     END OF OBSOLETE SECTION
%  ------------------------------------------------------------------------

\subsection{Command Descriptions}
\label{subsec:command_line_command_descriptions}

   This section describes the command-line commands in more detail.
   Obviously, some more needs to be written about some of the commands.
   Note that all the parameters for the \texttt{load} and \texttt{save}
   parameters are strings, and the parameters are compulsory, not optional.

   \setcounter{ItemCounter}{0}      % Reset the ItemCounter for this list.

   \itempar{..}{cmd!up one level}
      \index{cmd!..}
      Step back up one command context level.
      This command can immediately precede another command, so that the second
      command takes places at the context above the current context.

   \itempar{/}{cmd!to top level}
      \index{cmd!/}
      Step back up to the top command context level.
      This command can immediately precede another command, so that the second
      command takes places at the top context.

   \itempar{add bank [s]}{cmd!add bank}
      Define a new bank, \textsl{s}, where \textsl{s} is a bank name,
      and add it to the current root.

   \itempar{add root [s]}{cmd!add root}
      Define a new root path, \textsl{s}, and add it to the list of root paths.

   \itempar{remove bank [s]}{cmd!remove bank}
      Delete the bank named \textsl{s}, and all its contents,
      from the current root path.

   \itempar{remove root [s]}{cmd!remove root}
      De-list the root path named \textsl{s}.

   \itempar{list banks [n]}{cmd!list banks}
      List the instruments and IDs in bank \textsl{n} or the
      current bank/root.

   \itempar{list effects [n]}{cmd!list effects}
      List effect types for \textsl[n].
      If the parameter is the word \textsl{all},
      then list every effect and all its
      presets along with the preset number.

   \itempar{list history [s]}{cmd!list history}
      Displays the recently-used files, including patchsets, scales, and
      states.  If no parameter is given, then this command lists all three
      files in sequence.  The shortest version of this command is
      \texttt{l h p} (for patchsets, which returns the last-seen patchset list).

      \index{at-sign}
      \index{cmd!at-sign}
      \index{cmd!list operator}
      Once that list is displayed,
      the \texttt{@} operator can be used to access
      the item by number.  For example, to load the patch set at location 4 in
      the list:

      \begin{verbatim}
         yoshimi> lo p @4
      \end{verbatim}

   \itempar{list instruments [n]}{cmd!list instruents}
      List all instruments and IDs in bank \textsl{n}
      or the current bank/root.
      Listing instruments will identify the current one with an asterisk, and
      shows the current bank and root one is listing from, and adds a suffix to
      the entry with \textbf{A}, \textbf{S}, or \textbf{P}
      depending on the combination of AddSynth, SubSynth, and PadSynth.

   \itempar{list parts}{cmd!list parts}
      Lists the number of parts available and parts with instruments
      currently installed along with any enabled with the default sound.
      Also shows their audio destination:
      \textsl{M} = main L/R, \textsl{P} = part L/R, \textsl{B} = both, and
      \textsl{-} = disabled or unavailable.
      This way one can tell if an instrument patch is installed even if it is
      not currently usable.
      To avoid unnecessary list length, the default "Simple Sound" is not shown
      unless it is enabled.

   \itempar{list roots}{cmd!list roots}
      Displays all defined root paths.
      Listing roots will identify the current ones with an asterisk.

   \itempar{list setup}{cmd!list setup}
      Displays the current dynamic system settings.

   \itempar{list vector [n]}{cmd!list vector}
      Lists the settings for vector on channel \textsl{n}.

   \itempar{load instrument [s]}{cmd!load instrument}
      Loads an instrument into the current part from the named file.
%     The file-name parameter \textsl{s} is mandatory.

   \itempar{load patchset [s]}{cmd!load instrument}
      Load a complete patch set from a named file, \textsl{s}.
      A variation on this command is \texttt{load patchset @4}, which
      loads the patchset at location 4, the 4th item in the list.

   \itempar{load vector [s]}{cmd!load vector}
      Loads an vector setup from the named file.
      The file-name parameter \textsl{s} is mandatory.

   \itempar{save patchset [s]}{cmd!save patchset}
      Saves the current patchset to the file named \textsl{s}.

   \itempar{save instrument [s]}{cmd!save instrument}
      Saves the instrument of the current part to the named file.
      The file-name parameter \textsl{s} is mandatory.

   \itempar{save setup}{cmd!save setup}
      Save the current dynamic system settings.
      These settings get saved to the state file (we think).

   \itempar{save vector [s]}{cmd!save vector}
      Saves the vector setup to the named file.
      The file-name parameter \textsl{s} is mandatory.

   \itempar{set activate [n]}{cmd!set activate}
      Set part-activate on MIDI program change.
      \textsl{n}=0 disables this feature, and
      1 or any non-zero value enables this feature.
      This feature applies to command line program change as well.

   \itempar{set alsa audio [s]}{cmd!set alsa audio}
      Sets the name of the audio hardware device ALSA looks for.
      Requires a restart of \textsl{Yoshimi}.

   \itempar{set alsa midi [s]}{cmd!set alsa midi}
      Sets the name of the MIDI source ALSA looks for.
      Requires a restart of \textsl{Yoshimi}.

   \itempar{set available [n]}{cmd!set available}
      Set the number of available parts (16, 32, 64).
      Note that 32 and 64 are supported in the newest versions of
      \textsl{Yoshimi}.  Also note that a single two-part vector setup (the
      \textbf{X} vector) requires 32 parts, while the dual two-part vector
      setup (both \textbf{X} and \textbf{Y}) requires 64 parts.

   \itempar{set bank [n]}{cmd!set bank}
      Set current bank to ID \textsl{n}.

   \itempar{set ccbank [n]}{cmd!set ccbank}
      Set the MIDI CC for bank changes (anything other than 0 or 32
      disables MIDI CC).

   \itempar{set ccroot [n]}{cmd!set ccroot}
      Set the MIDI CC for root path changes (values above 119 disable this
      feature).

   \itempar{set extend [n]}{cmd!set extend}
      Set CC value for extended program change (values above 119 disables this
      feature).

   \itempar{set insert effects [n]}{cmd!set insert effects}
      Set insertion effects for editing.
      What are the possible values of \textsl{n}?

   \itempar{set jack midi [s]}{cmd!set jack midi}
      Sets the name of the JACK MIDI source for Yoshimi.
      Requires a restart of \textsl{Yoshimi}.

   \itempar{set jack server [s]}{cmd!set jack server}
      Sets the name of the JACK server Yoshimi tries to connect to.
      Requires a restart of \textsl{Yoshimi}.

   \itempar{set part [n1] program [n2]}{cmd!set part program}
      Load instrument \textsl{n2} into part \textsl{n1}.
      Example: \texttt{set part 4 program 130}

   \itempar{set part [n1] channel [n2]}{cmd!set part channel}
      Set the MIDI channel \textsl{n2} for part \textsl{n1}.
      If the channel number is greater than 15, no further MIDI
      messages will be accepted by that part.

   \itempar{set part [n1] destination [n2]}{cmd!set part destination}
      Set the audio destination of part \textsl{n1}
      to main (\textsl{1}), part (\textsl{2}), both (\textsl{3}).
      Also enables the part if not already enabled.

   \itempar{set preferred audio [s]}{cmd!set preferred audio}
      Set the audio connection type.
      The parameter should be either "jack" or "alsa".

   \itempar{set preferred midi [s]}{cmd!set preferred midi}
      Set the MIDI connection type.
      The parameter should be either "jack" or "alsa".

   \itempar{set - preset [n]}
      Set effect preset.
      Set numbered effect preset.

   \itempar{set program [n]}{cmd!set program}
      Set MIDI program change (0 disables, anything else enables).

   \itempar{set reports [n]}{cmd!set reports}
      Sets the report destination or where messages are displayed, and, to some
      extent, which messages are displayed.  Here are the variations on this
      command that are supported:

      \begin{itemize}
         \item \texttt{set reports gui} or \texttt{s r g}.
            All reports are sent to the GUI console window.
         \item \texttt{set reports stderr} or \texttt{s r s}.
            All reports are sent to stderr.
         \item \texttt{set reports show} or \texttt{s r sh}.
            All messages are displayed.
         \item \texttt{set reports hide} or \texttt{s r h}.
            Non fatal low-level messages are discarded.
         \item \texttt{set reports (any other word or nothing at all)} or
            \texttt{s r (other)}.
            This sets the default condition of sending reports to the CLI and
            displaying all of them.
      \end{itemize}

   \itempar{set root [n]}{cmd!set root}
      Set current root path to ID \textsl{n}.

   \itempar{set shift [n]}{cmd!set shift}
      Set the master key shift for following notes in semitones (+-
      octave, 64 for no shift).

   \itempar{set system effects [n]}{cmd!set system effects}
      Set System Effects for editing.

   \itempar{set vector [n1] x/y cc [n2]}{cmd!set vector cc}
      CC \textsl{n2} is used for channel \textsl{n1} X or Y axis sweep.
      For X, this also enables vector control for the channel.

      \index{vector!features}
      The individual features are now numbered 1-4 and can be
      \index{vector!enable} \texttt{enabled} or
      \index{vector!reverse} \texttt{reversed} (any
      other word disables the feature).
      "Reversed" means that, instead of the X left rising in
      value with increasing CC value, it decreases.
      X right does the opposite of course.

      Feature 1 is always fixed as 7 (volume) and is not reversible.
      Features 2 to 4 can also have the outgoing CC changed to any valid one.
      The vector is just about the only command-line
      entry that starts from 1.

      The original system where bits were ORred together was done to make NRPN
      control as efficient as possible. That hasn't changed, but log messages
      refer to the command-line numbering.

      A more detailed discussion of command-line vector control is presented in
      \sectionref{subsection:vector_command_line}.

   \itempar{set vector [n1] x/y features [n2]}{cmd!set vector features}
      Sets channel \textsl{n1} X or Y features to \textsl{n2}.

   \itempar{set vector [n1] x/y program [l/r] [n2]}{cmd!set vector program}
      Loads program \textsl{n2} to channel \textsl{n1} X or Y
      \textsl{left} or \textsl{right} part.

   \itempar{set vector [n1] x/y control [n2] [n3]}{cmd!set vector control}
      Sets \texttt{n3} CC to use for X or Y feature \texttt{n2} (2, 4, 8).
      \textsl{n3} is the CC to be used for feature number \textsl{n2} on X
      vector channel \textsl{n1}. The \textsl{x} is a sort of hidden parameter
      as the code uses an offset dependent on whether it is \textsl{x} or
      \textsl{y}. Also \textsl{n1} can be omitted in which case it will use the
      last defined channel number. Using alternate words and numbers gives a
      great deal of flexibility like this.

   \itempar{set vector [n] [off]}{cmd!set vector}
      Disables vector control for channel \textsl{n}.

   \itempar{set volume [n]}{cmd!set volume}
      Set the master volume.

   \itempar{reset}{cmd!reset}
      Return to the start-up conditions, if 'y' selected.

   \itempar{stop}{cmd!stop}
      Cease all sound immediately!

   \itempar{? or help}{cmd!help}
      List commands for current mode.  All of the minimum command-line
      abbrevations are capitalised in the help listing.

   \itempar{exit}{cmd!exit}
         Tidy up and close Yoshimi down.

%  ------------------------------------------------------------------------
%     START OF REDUNDANT SECTION
%  ------------------------------------------------------------------------

\iffalse

\subsection{Command List}
\label{subsec:command_line_command_list}

   This section provides another list of CLI commands, and should be considered
   the most complete.  We will reconcile it all at some point.
   First, some general commands.  The capital letters denote the minimum token
   needed for each command.

\fi

\iffalse
\begin{verbatim}
   ?,  Help                      Show commands.
   STop                          All sound off.  Stop!
   RESet                         Return to start-up conditions (if 'y').
   EXit                          Tidy up and close Yoshimi (if 'y').
   ..                            Step back one command level.
   /                             Step back to top command level.
\end{verbatim}

   Commands to list various items.

\begin{verbatim}
   List                          Various available parameters.
      Roots                      All available root paths.
      Banks [n]                  Banks in root ID or current.
      Instruments [n]            Instruments in bank ID or current.
      Parts                      Parts with instruments installed.
      Vectors                    Settings for all enabled vectors.
      Settings                   Dynamic settings.
      MLearn [s[n]]              MIDI learned controls; '@n' for full details, one line.
      History [s]                Recent files; Patchsets, SCales, STates, Vectors, MLearn.
      Effects [s]                Effect types; 'all' include preset numbers and names.
      PREsets                    All the presets for the current selected effect.
\end{verbatim}

   Commands to load various items.

\begin{verbatim}
   LOad                          Load patch files.
      Instrument [s]             Instrument to current part from named file.
      Patchset [s]               Complete set of instruments from named file.
      STate [s]                  All system settings and patch sets from named file.
      SCale [s]                  Scale settings from named file.
      VEctor [n] [s]             Vector on channel n from named file.
      MLearn [s]                 MIDI learned list from named file.
\end{verbatim}

   Commands to save various items.

\begin{verbatim}
   SAve                          Save various files.
      Instrument [s]             Current part to named file.
      Patchset [s]               Complete set of instruments to named file.
      STate [s]                  All system settings and patch sets to named file.
      SCale [s]                  Current scale settings to named file.
      VEctor <{Channel}n> [s]    Vector on channel n to named file.
      MLearn [s]                 MIDI learned list to named file.
      Setup                      Dynamic settings.
\end{verbatim}

   Commands to add and remove various items.

\begin{verbatim}
   ADD                           Add paths and files.
      Root [s]                   Root path to list.
      Bank [s]                   Bank to current root.
   REMove                        Remove paths, files and entries.
      Root [n]                   De-list root path ID.
      Bank [n]                   Delete bank ID and all contents from current root.
      MLearn [s] [n]             Delete MIDI learned 'ALL' whole list, or '@'(n) line.
\end{verbatim}

   Commands to set and read some items.  ARE ANY OF THESE STILL ACTIVE?

\begin{verbatim}
   Set / Read                    Set or read all main parameters
      SWitcher [{CC}n] [s]       Define CC n to set single part in group (Row / Column)
      REPorts [s]                Destination (Gui/Stderr)
                                   Non-fatal (SHow/Hide)
      Root [n]                   Current root path to ID
      Bank [n]                   Current bank to ID
      MLearn [n] [s] [s]         midi learned line n control (MUte, CC, CHan, MIn,
                                 MAx, LImit, BLock) Enable {other}
\end{verbatim}

   Commands to set and read parts.

\begin{verbatim}
      Part [n1]                  Set part ID operations
        ENable                   Enables the part
        DIsable                  Disables the part
        Volume [n2]              Volume
        Pan [n2]                 Panning
        VElocity [n2]            Velocity sensing sensitivity
        OFfset [n2]              Velocity sense offest
        POrtamento [s]           Portamento (Enable, other disable
        Mode [s]                 Key mode (Poly, Mono, Legato)
        Note [n2]                Note polyphony
        SHift [n2]               Key shift semitones (0 no shift)
        MIn [n2]                 Minimum MIDI note value
        MAx [n2]                 Maximum MIDI note value
        EFfects [n2]             Effects for editing
        Type [s]                 The effect type
        PREset [n3]              Set numbered effect preset to n3
        Send [n3] [n4]           Send part to system effect n3 at volume n4
        PRogram [n2]             loads instrument ID
        NAme [s]                 Sets the display name the part can be saved with
        Channel [n2]             MIDI channel (> 31 disables, > 15 note off only)
        Destination [s2]         JACK audio destination (Main, Part, Both)
\end{verbatim}

   Commands to set or read vectors.

\begin{verbatim}
      VEctor [n1]                Vector CHANNEL, operations
        [X/Y] CC [n2]            CC n2 is used for CHANNEL X or Y axis sweep
        [X/Y] Features [n2] [s]  Sets CHANNEL X or Y features 1-4 (Enable, Reverse, {other} off)
        [X] PRogram <l/r> [n2]   X program change ID for CHANNEL LEFT or RIGHT part
        [Y] PRogram <d/u> [n2]   Y program change ID for CHANNEL DOWN or UP part
        [X/Y] Control [n2] [n3]  Sets n3 CC to use for X or Y feature n2 (2-4)
        Off                      Disable vector for CHANNEL
\end{verbatim}

   Commands to set or read effects and presets.

\begin{verbatim}
      SYStem effects [n]         System effects for editing
      Send [n2] [n3]             Send system effect to effect n2 at volume n3
      preset [n2]                Set effect preset to number n2

      INSert effects [n1]        Insertion effects for editing
      Send [s]/[n2]              Set where (Master, Off or part number)
      PREset [n2]                Set numbered effect preset to n2
\end{verbatim}

   Commands to set or read programs and more.

\begin{verbatim}
      PRogram [n]                MIDI program change enabled (0 off, other on)
      ACtivate [n]               MIDI program change activates part (0 off, other on)
      CCRoot [n]                 CC for root path changes (> 119 disables)
      CCBank [n]                 CC for bank changes (0, 32, other disables)
      EXtend [n]                 CC for extended MIDI program change (> 119 disables)
      AVailable [n]              Available parts (16, 32, 64)
      Volume [n]                 Master volume
      SHift [n]                  Master key shift semitones (0 no shift)
      DEtune [n]                 Master fine detune
      SOlo [n]                   Channel 'solo' switcher (off, row, col, loop)
      SCC [n]                    Incoming 'solo' channel number
      TIMes [s]                  Time display on instrument load message (ENable / other
\end{verbatim}

      These entries need to be saved and Yoshimi restarted to activate:

\begin{verbatim}
      PREferred Midi [s]         MIDI connection type (Jack, Alsa)
      PREferred Audio [s]        Audio connection type (Jack, Alsa)
      Alsa Midi [s]              Name of alsa MIDI source
      Alsa Audio [s]             Name of alsa hardware device
      Jack Midi [s]              Name of jack MIDI source
      Jack Server [s]            JACK server name
      Jack AUto [s]              0 off, other on
      AUTostate [s]              Autoload default state at start (ENable / other)
\end{verbatim}

\fi

%  ------------------------------------------------------------------------
%     END OF REDUNDANT SECTION
%  ------------------------------------------------------------------------

\subsection{Direct Access}
\label{subsec:command_line_direct_access}

   \index{Direct Access}
   \index{cmd!direct access}
   \textsl{Direct Access} is a very low-level access method for most of the
   controls in \textsl{Yoshimi} control.
   It is a test feature accessible only from the command line.
   There are virtually no error checks on direct-access, so one can easily
   crash Yoshimi with out of range values.
   It mostly updates the GUI too.
   Refer to the \texttt{Yoshimi Control Numbers.ods} file that ships with the
   source-code
   for control numbers, actions, and \texttt{GUI\_Interpretations.txt}
   further explanations.
   Also, see \texttt{Effect\_Inserts.txt} for the actual effect controllers and
   \texttt{Envelope\_Inserts} for the enveople controller ranges.

   Sections currently supported by direct access:

   \begin{itemize}
      \item Top level controls
      \item MIDI-learn, used for all operations
      \item Main part controls, now used by GUI for writes
      \item Controllers Window
      \item MIDI CCs window, used for all except incoming real MIDI
      \item Kit edit window
      \item AddSynth Editor
      \item AddSynth Voice Editor
      \item SubSynth Editor
      \item PadSynth Editor
      \item Oscillator
      \item Resonance
      \item Effects
      \item LFOs
      \item Filters
      \item Envelopes
   \end{itemize}

   The remaining sections display as if written to, but don't change anything.

   The official direct access numbering system is zero based (and will remain
   so).

%  This matches the results from using the middle mouse button in the GUI
%  (assuming it was enabled at build time). Commands that are purely within
%  the GUI, e.g window changes are recognised but not acted on.
%
%  An alternative way to find out the correct command sequence is to click on
%  a control with any button *except* the middle one. Trailing '255's can be
%  ommitted if there are no following parameters set.
%
%  In some situations par2 is used as a miscMSG ID for passing text values
%  between threads but synchronised via the RT thread.

   The format of the direct-access command is:

   \begin{verbatim}
      direct [value] [type] [control] [part] [kit] [engine] [insert] [parameter] [par2]
   \end{verbatim}

   \begin{itemize}
      \item \texttt{direct} is the actual command name, must be typed in full.
      \item \texttt{value} is the value that will be set, may be negative and
         floating point (looks for the devimal point).
      \item \texttt{type} is a subset of the command type: 0 for read and 64 for
         write. Sending 1 will just echo the bytes you sent.  Sending 3 will
         turn it into a MIDI-learn command.
      \item \texttt{control} is the number representing the control being
         changed or queried.
      \item \texttt{part} is the number of the part being changed.
   \end{itemize}

   All the parameters above are mandatory. The following must also be entered in
   sequence when needed.

   \begin{itemize}
      \item \texttt{kit} is a part's kit number (if enabled otherwise zero).
         also used for effects.
      \item \texttt{engine} is the synth engine being adjusted.
      \item \texttt{insert} is harmonics, LFOs, filters etc.
      \item \texttt{parameter} is subtype associated with some inserts.
      \item \texttt{par2} is an offset for some parameters.
   \end{itemize}

   A variation of the above is when you set flt\_max as the \texttt{value}.
   This value will
   be interpeted as requesting the min, max, and default values for the
   command and using the same 'CommandBlock' struct will return them as short
   integers in the form:

   \begin{verbatim}
      limits.min
      limits.max
      limits.def
   \end{verbatim}

   Only a few of these are independently declared so far, all the rest have the
   values: min = 0, max = 127, and def = 0.  \textbf{def} will return the
   default times 10. This is so that fractional values can be resolved. 0.5 comes
   up quite often. No default values are very large, but may be negative.

   A number of limits are now defined, and more will be forthcoming. There is
   now a specific variation for this. "direct", "lim", (control), (part), (kit)
   etc.  These commands now give the corrected default value and report the
   full name of the control, and as well as the limits, it gives the type
   (float/integer) and notes if it is MIDI learnable.

   CLI direct access to show limits returns a single value dependent on the
   initial text and parameters.  Some examples:
   The control number for volume, part number, will return:

   \begin{verbatim}
      direct limit max 0 0
      Max 127.000000
   \end{verbatim}

   For panning:

   \begin{verbatim}
      direct limit  def 1 0
      Default 64.000000
   \end{verbatim}

   For keyshift, top level controls:

   \begin{verbatim}
      direct limit min 35 240
      min -36.000000
   \end{verbatim}

	From the command line you can now read the VU levels:

   \begin{verbatim}
		direct 0 0 200 240 {part number}
   \end{verbatim}

	will show the numbered part's peak level.
 	It will be negative if the part is not enabled.

   \begin{verbatim}
      direct 0 0 201 240 0
   \end{verbatim}

gives the main output LH peak.

   \begin{verbatim}
      direct 0 0 201 240 1
   \end{verbatim}

gives the main output RH peak.

   \begin{verbatim}
      direct 0 0 202 240 0
   \end{verbatim}

gives the main output LH RMS.

   \begin{verbatim}
      direct 0 0 202 240 1
   \end{verbatim}

gives the main output RH RMS.

   Obviously, these are fluctuating values, but give an idea of what is
   happening.  Those zeros at the start are necessary; and the commands are
   exactly what the GUI requests when updating the displays.

%-------------------------------------------------------------------------------
% vim: ts=3 sw=3 et ft=tex
%-------------------------------------------------------------------------------
